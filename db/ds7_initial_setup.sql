CREATE DATABASE IF NOT EXISTS ds7;

USE ds7;

#tratar de  poner una pausa aqui
 CREATE TABLE tbl_trip_analysis (
    `TRIP_ID` INT,
    `CHECKPOINT_A` INT,
    `CHECKPOINT_B` INT,
    `DATE_INI` DATE,
    `DATE_END` DATE,
    `COST` NUMERIC(4, 2),
    `VOLUME` NUMERIC(5, 3),
    `LENGTH` INT,
    `TIME` INT,
    `FUEL_ECONOMY` NUMERIC(5, 3),
    `COST_RATE` NUMERIC(3, 2)
);

INSERT INTO tbl_trip_analysis VALUES
    (190628,37214,37514,STR_TO_DATE('2019-06-28', '%Y-%m-%d')+1,STR_TO_DATE('2019-07-09', '%Y-%m-%d')+1,19.02,24.99,300,11,12.005,1.73),
    (190709,37514,37913,STR_TO_DATE('2019-07-09', '%Y-%m-%d')+1,STR_TO_DATE('2019-07-16', '%Y-%m-%d')+1,20.59,25.642,399,7,15.56,2.94),
    (190716,37913,38309,STR_TO_DATE('2019-07-16', '%Y-%m-%d')+1,STR_TO_DATE('2019-07-24', '%Y-%m-%d')+1,20.14,24.12,396,8,16.418,2.52),
    (190724,38309,38722,STR_TO_DATE('2019-07-24', '%Y-%m-%d')+1,STR_TO_DATE('2019-08-01', '%Y-%m-%d')+1,20.12,24.098,413,8,17.138,2.56),
    (190801,38722,38929,STR_TO_DATE('2019-08-01', '%Y-%m-%d')+1,STR_TO_DATE('2019-08-07', '%Y-%m-%d')+1,15,17.964,207,7,11.523,2.14),
    (190807,38929,39333,STR_TO_DATE('2019-08-07', '%Y-%m-%d')+1,STR_TO_DATE('2019-08-17', '%Y-%m-%d')+1,20.44,24.479,404,11,16.504,1.86),
    (190817,39333,39667,STR_TO_DATE('2019-08-17', '%Y-%m-%d')+1,STR_TO_DATE('2019-08-26', '%Y-%m-%d')+1,19.57,25.42,334,10,13.14,1.96),
    (190826,39667,40004,STR_TO_DATE('2019-08-26', '%Y-%m-%d')+1,STR_TO_DATE('2019-09-03', '%Y-%m-%d')+1,17.63,22.929,337,9,14.698,1.96),
    (190903,40004,40346,STR_TO_DATE('2019-09-03', '%Y-%m-%d')+1,STR_TO_DATE('2019-09-11', '%Y-%m-%d')+1,17.92,23.078,342,11,14.819,1.63),
    (190911,40346,40696,STR_TO_DATE('2019-09-11', '%Y-%m-%d')+1,STR_TO_DATE('2019-09-18', '%Y-%m-%d')+1,17.86,23.474,350,8,14.91,2.23),
    (190918,40696,41071,STR_TO_DATE('2019-09-18', '%Y-%m-%d')+1,STR_TO_DATE('2019-09-25', '%Y-%m-%d')+1,17.79,23.279,375,8,16.108,2.22),
    (190925,41071,41453,STR_TO_DATE('2019-09-25', '%Y-%m-%d')+1,STR_TO_DATE('2019-10-02', '%Y-%m-%d')+1,17.23,23.126,382,8,16.518,2.15),
    (191002,41453,41854,STR_TO_DATE('2019-10-02', '%Y-%m-%d')+1,STR_TO_DATE('2019-10-11', '%Y-%m-%d')+1,17.69,23.335,401,10,17.184,1.77),
    (191011,41854,42241,STR_TO_DATE('2019-10-11', '%Y-%m-%d')+1,STR_TO_DATE('2019-10-21', '%Y-%m-%d')+1,17.93,23.97,387,11,16.145,1.63),
    (191021,42241,42647,STR_TO_DATE('2019-10-21', '%Y-%m-%d')+1,STR_TO_DATE('2019-10-28', '%Y-%m-%d')+1,18.71,25.28,406,8,16.06,2.34),
    (191028,42647,43009,STR_TO_DATE('2019-10-28', '%Y-%m-%d')+1,STR_TO_DATE('2019-11-12', '%Y-%m-%d')+1,17.68,23.575,362,16,15.355,1.11),
   (191112,43009,43376,STR_TO_DATE('2019-11-12', '%Y-%m-%d')+1,STR_TO_DATE('2019-11-22', '%Y-%m-%d')+1,18.40,24.336,367,11,15.081,1.67),
      (191122,43376,43705,STR_TO_DATE('2019-11-22', '%Y-%m-%d')+1,STR_TO_DATE('2019-12-02', '%Y-%m-%d')+1,15.79,20.244,329,11,16.252,1.44);



DROP PROCEDURE IF EXISTS sp_getEngineData;

DELIMITER //
CREATE PROCEDURE sp_getEngineData() BEGIN
SELECT
	tta.TRIP_ID,
	tta.CHECKPOINT_A,
	tta.CHECKPOINT_B,
	tta.DATE_INI,
	tta.DATE_END,
	tta.COST,
	tta.VOLUME,
	tta.LENGTH,
	tta.TIME,
	tta.FUEL_ECONOMY,
	tta.COST_RATE
FROM
	tbl_trip_analysis tta;
END//

CALL sp_getEngineData();

#
#
#
DELIMITER //
CREATE PROCEDURE sp_setEngineData( in P_TRIP_ID int,
in P_TIME int,
in P_FUEL_ECONOMY DECIMAL(5,
3),
in P_COST_RATE DECIMAL(3,
2))
BEGIN
INSERT
	INTO
	tbl_trip_analysis(TRIP_ID,
	TIME,
	FUEL_ECONOMY,
	COST_RATE)
VALUES(P_TRIP_ID,
P_TIME,
P_FUEL_ECONOMY,
P_COST_RATE);
END // 

#
#
#
CALL sp_getEngineData(); 

